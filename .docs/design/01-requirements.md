# 요구사항 정리

## 배경

**감성 이커머스 플랫폼**으로 브랜드의 이야기와 감성을 담은 상품을 제공합니다. 사용자들은 다양한 브랜드와 상품을 탐색하고, 마음에 드는 상품에 좋아요를 표시하며, 간편하게 주문할 수 있습니다.

### 주요 목표 및 특징

- **브랜드 중심 설계**: 각 브랜드의 스토리와 철학을 전달
- **간편한 탐색**: 비회원도 브랜드와 상품을 자유롭게 둘러볼 수 있음
- **소셜 기능**: 회원은 좋아요를 통해 관심 상품을 표시
- **주문 관리**: 회원의 주문 이력 관리 및 관리자의 전체 주문 관리
- **관리자 기능**: 브랜드, 상품, 주문을 효율적으로 관리

## 서비스 흐름 예시

```
1. [회원가입/로그인]
   → 사용자가 계정 생성 또는 로그인

2. [상품 둘러보기]
   → 비회원도 브랜드 목록, 상품 목록 조회 가능
   → 브랜드별 상품 필터링, 정렬(최신순/가격순/좋아요순)

3. [좋아요]
   → 회원은 마음에 드는 상품에 좋아요 표시
   → 좋아요 취소 가능

4. [주문]
   → 회원이 상품 주문 요청 (상품, 수량, 배송지 정보 입력)
   → 재고 확인 후 주문 생성
   → 주문 내역 조회

5. [관리자]
   → 브랜드/상품 등록, 수정, 삭제
   → 전체 주문 목록 관리
```

## 전체 기능 개요

### 유저 관리
- 회원가입 및 로그인
- 비회원도 브랜드/상품 조회 가능
- 회원만 좋아요 및 주문 가능

### 브랜드 & 상품 조회
- **브랜드 조회**: 브랜드 정보 및 해당 브랜드의 상품 목록
- **상품 목록 조회**: 전체 상품 또는 브랜드별 상품, 정렬 옵션 제공
- **상품 상세 조회**: 상품명, 가격, 이미지, 설명, 재고 등

### 좋아요
- 회원만 상품에 좋아요/취소 가능
- 좋아요 수는 상품 목록에 표시

### 주문
- **주문 요청**: 회원이 상품 주문 (재고 확인 및 차감)
- **주문 조회**: 회원 본인의 주문 목록 및 상세 정보 조회

### 관리자 기능
- **브랜드 관리**: 등록, 수정, 삭제, 목록/상세 조회
- **상품 관리**: 등록, 수정, 삭제, 목록/상세 조회
- **주문 관리**: 전체 주문 목록 및 상세 조회

## API 설계 원칙

### API 버전 Prefix
- **사용자 API**: `/api/v1`
- **관리자 API**: `/api-admin/v1`

### 인증 방식 (헤더 기반)

**사용자 인증** (회원 기능 사용 시):
```
X-Loopers-LoginId: {userId}
X-Loopers-LoginPw: {password}
```

**관리자 인증** (관리자 기능 사용 시):
```
X-Loopers-Ldap: {adminId}
```

### 페이지네이션 기본값
- 기본 페이지 크기: `20`
- 페이지 번호: `0`부터 시작

## API 엔드포인트 목록

### 유저 (Users)

| Method | Endpoint | 설명 |
|--------|----------|------|
| POST | `/api/v1/users/signup` | 회원가입 |
| POST | `/api/v1/users/login` | 로그인 |

### 브랜드 & 상품 (Brands / Products)

| Method | Endpoint | 설명 |
|--------|----------|------|
| GET | `/api/v1/brands/{brandId}` | 브랜드 정보 조회 |
| GET | `/api/v1/products` | 상품 목록 조회 |
| GET | `/api/v1/products/{productId}` | 상품 상세 조회 |

### 브랜드 & 상품 ADMIN

| Method | Endpoint | 설명 |
|--------|----------|------|
| GET | `/api-admin/v1/brands` | 브랜드 목록 조회 |
| GET | `/api-admin/v1/brands/{brandId}` | 브랜드 상세 조회 |
| POST | `/api-admin/v1/brands` | 브랜드 등록 |
| PUT | `/api-admin/v1/brands/{brandId}` | 브랜드 정보 수정 |
| DELETE | `/api-admin/v1/brands/{brandId}` | 브랜드 삭제 |
| GET | `/api-admin/v1/products` | 상품 목록 조회 |
| GET | `/api-admin/v1/products/{productId}` | 상품 상세 조회 |
| POST | `/api-admin/v1/products` | 상품 등록 |
| PUT | `/api-admin/v1/products/{productId}` | 상품 정보 수정 |
| DELETE | `/api-admin/v1/products/{productId}` | 상품 삭제 |

### 좋아요 (Likes)

| Method | Endpoint | 설명 |
|--------|----------|------|
| POST | `/api/v1/likes/{productId}` | 좋아요 토글 (추가/취소) |

### 주문 (Orders)

| Method | Endpoint | 설명 |
|--------|----------|------|
| POST | `/api/v1/orders` | 주문 요청 |
| GET | `/api/v1/orders` | 주문 목록 조회 |
| GET | `/api/v1/orders/{orderId}` | 주문 상세 조회 |

### 주문 ADMIN

| Method | Endpoint | 설명 |
|--------|----------|------|
| GET | `/api-admin/v1/orders` | 전체 주문 목록 조회 |
| GET | `/api-admin/v1/orders/{orderId}` | 주문 상세 조회 |


## 주요 비즈니스 규칙

### 브랜드 관리
- **브랜드 삭제 시**: 브랜드를 삭제하면 해당 브랜드의 모든 상품도 함께 삭제됩니다.

### 상품 관리
- **상품 등록 제약**: 상품을 등록할 때 해당 브랜드가 이미 등록되어 있어야 합니다.
- **브랜드 변경 불가**: 상품 수정 시 브랜드는 변경할 수 없습니다. (브랜드를 변경하려면 상품을 삭제 후 재등록)

### 주문 처리
- **상품 스냅샷 저장**: 주문 생성 시 주문 당시의 상품 정보(상품명, 가격 등)를 스냅샷으로 저장하여, 이후 상품 정보가 변경되어도 주문 내역은 주문 당시의 정보를 유지합니다.
- **재고 확인 및 차감**: 주문 요청 시 상품 재고를 확인하고, 재고가 충분할 경우에만 주문을 생성하며 재고를 차감합니다. 재고가 부족하면 에러를 반환합니다.

### 좋아요
- **토글 방식**: 좋아요는 토글 방식으로 동작합니다. 이미 좋아요한 상품에 다시 좋아요를 요청하면 좋아요가 취소됩니다.
- **회원 전용**: 회원만 좋아요 기능을 사용할 수 있습니다.

## 상세 유스케이스

### 브랜드 정보 조회

**[유저 스토리]**
- 비회원 및 회원은 특정 브랜드를 조회할 수 있다.
- 조회 시 브랜드의 정보와 해당 브랜드의 상품을 볼 수 있다.

**[기능 흐름]**
- 비회원도 브랜드 조회 가능.
- brandId를 통해 브랜드 정보 조회.

**[유스케이스 흐름]**

Main Flow
1. brandId를 통해 브랜드 정보 조회.
2. 브랜드 상세 정보 (브랜드명, 소개글, 대표 상품 등) 반환.

Alternative Flow
1. 브랜드는 존재하나 등록된 상품이 없을 시 상품을 빈 리스트로 반환

Exception Flow
1. brandId가 존재하지 않을 시(404) 에러 반환
2. 서버 에러 시(500) 에러 반환
---
### 상품 목록 조회

**[유저 스토리]**
- 비회원 및 회원은 상품 목록을 조회할 수 있다.
- 전체 상품 또는 특정 브랜드의 상품을 조회할 수 있다.
- 각 상품의 상품명, 가격, 상품 이미지, 브랜드명, 좋아요 수를 확인할 수 있다.

**[기능 흐름]**
- 비회원도 상품 목록 조회 가능.
- 기본 20개의 상품씩 페이지네이션 처리.
- 상품 목록은 최신순, 가격순, 좋아요 순으로 정렬 가능.

**[유스케이스 흐름]**

Main Flow
1. 상품 목록 조회.
2. 기본 정렬(latest)과 기본 페이징(page=0, size=20)의 상품 목록 반환

Alternative Flow
1. 정렬 기준 변경 시 정렬 기준(latest / price_asc / likes_desc)에 맞는 상품 목록 확인.
2. 등록된 상품 없을 시 빈 리스트 반환

Exception Flow
1. 서버 에러 시(500) 에러 반환
---
### 상품 정보 조회

**[유저 스토리]**
- 비회원 및 회원은 상품 상세 정보를 확인할 수 있다.
- 상품의 상품명, 상품 이미지, 상품 설명, 가격 등을 확인할 수 있다.

**[기능 흐름]**
- 비회원 및 회원 상품 상제 정보 조회 가능

**[유스케이스 흐름]**

Main Flow
1. 사용자가 productId를 통해 상품 상세 정보 조회.
2. 해당 상품의 상세 정보 반환.

Alternative Flow

Exception Flow
1. productId가 존재하지 않을 시(404) 에러 반환
2. 서버 에러 시(500) 에러 반환
---
### Admin 브랜드 목록 및 상세 조회

**[유저 스토리]**
- 관리자는 브랜드 목록을 조회할 수 있다.
- 특정 브랜드의 상세 정보를 조회할 수 있다.
- 상세 조회 시 등록된 상품 목록, 갯수 등 확인할 수 있다.

**[기능 흐름]**
- 기본 20개의 브랜드 페이지네이션 처리
- 브랜드 목록은 이름순으로 정렬 가능.
- brandId를 통해 상세조회 가능

**[유스케이스 흐름]**

Main Flow
1. 관리자가 브랜드 목록 조회
2. 기본 20개의 브랜드 목록 반환
3. brandId를 통해 상세조회
4. 해당 브랜드의 상세 정보 반환

Alternative Flow
1. 이름순 정렬(오름차순, 내림차순)을 통해 브랜드 목록 조회

Exception Flow
1. 등록된 브랜드 없을 시 빈 리스트 반환
2. brandId가 존재하지 않을 시(404) 에러 반환
3. 서버 에러 시(500) 에러 반환

---
### Admin 브랜드 등록

**[유저 스토리]**
- 관리자는 브랜드를 등록할 수 있다.
- 브랜드명, 썸네일 이미지, 소개글 등 브랜드 정보를 입력한다.

**[기능 흐름]**
- 관리자가 브랜드 정보를 입력하고 등록.

**[유스케이스 흐름]**

Main Flow
1. 관리자가 브랜드 정보 입력
2. 브랜드 정보 등록
3. 완료 응답 반환

Alternative Flow
1.

Exception Flow
1. 필수 정보 누락 시 에러 반환
2. 서버 에러 시(500) 에러 반환

---
### Admin 브랜드 정보 수정

**[유저 스토리]**
- 관리자는 브랜드 정보를 수정할 수 있다.
- 브랜드명, 썸네일 이미지, 소개글 등 브랜드 정보를 수정한다.

**[기능 흐름]**
- 관리자가 브랜드 정보를 수정.

**[유스케이스 흐름]**

Main Flow
1. 관리자가 브랜드 정보 확인
2. 수정할 정보 수정
3. 완료 응답 반환

Alternative Flow

Exception Flow
1. 필수 정보 누락 시 에러 반환
2. 서버 에러 시(500) 에러 반환

---
### Admin 브랜드 삭제

**[유저 스토리]**
- 관리자는 브랜드를 삭제할 수 있다.

**[기능 흐름]**
- 관리자가 브랜드 삭제.

**[유스케이스 흐름]**

Main Flow
1. 관리자가 브랜드 삭제
2. 완료 응답 반환

Alternative Flow

Exception Flow
1. 필수 정보 누락 시 에러 반환
2. 서버 에러 시(500) 에러 반환

---
### Admin 상품 목록 및 상세 조회

**[유저 스토리]**
- 관리자는 상품 목록을 조회할 수 있다.
- 전체 상품 또는 특정 브랜드의 상품을 조회할 수 있다.
- 각 상품의 상품명, 가격, 상품 이미지, 브랜드명, 좋아요 수를 확인할 수 있다.
- productId를 통해 상품 상세 정보를 조회할 수 있다.

**[기능 흐름]**
- 기본 20개씩 페이지네이션 처리.
- 상품 목록은 최신순, 가격순, 좋아요 순으로 정렬 가능.

**[유스케이스 흐름]**

Main Flow
1. 관리자가 상품 목록 조회
2. 기본 정렬(latest)과 기본 페이징(page=0, size=20)의 상품 목록
3. productId를 통해 상품 상세 정보 조회

Alternative Flow
1. 정렬 기준 변경 시 정렬 기준(latest / price_asc / likes_desc)에 맞는 상품 목록 확인.
2. 등록된 상품 없을 시 빈 리스트 반환

Exception Flow
1. productId가 존재하지 않을 시(404) 에러 반환
2. 서버 에러 시(500) 에러 반환

---
### Admin 상품 등록

**[유저 스토리]**
- 관리자는 상품을 등록할 수 있다.
- 상품명, 상품 이미지, 상품 설명, 가격 등 상품 정보를 입력하여 등록한다.

**[기능 흐름]**
- 관리자가 상품 정보를 입력하고 등록.

**[유스케이스 흐름]**

Main Flow
1. 관리자가 상품 정보 입력
2. 상품 정보 등록
3. 완료 응답 반환

Alternative Flow

Exception Flow
1. 필수 정보 누락 시 에러 반환
2. 서버 에러 시(500) 에러 반환

---
### Admin 상품 정보 수정

**[유저 스토리]**
- 관리자는 상품 정보를 수정할 수 있다.
- 상품명, 상품 이미지, 상품 설명, 가격 등 상품 정보를 수정한다.

**[기능 흐름]**
- 관리자가 상품 정보를 수정.
- 상품 존재 여부 확인.
- 있으면 수정 처리, 없으면 에러 반환.

**[유스케이스 흐름]**

Main Flow
1. 관리자가 상품 정보 수정
2. 완료 응답 반환


Exception Flow
1. 필수 정보 누락 시 에러 반환
2. 서버 에러 시(500) 에러 반환

---
### Admin 상품 삭제

**[유저 스토리]**
- 관리자는 상품을 삭제할 수 있다.

**[기능 흐름]**
- 관리자가 상품 삭제.
- 상품 존재 여부 확인.
- 있으면 삭제 처리, 없으면 에러 반환.

**[유스케이스 흐름]**

Main Flow
1. 관리자가 상품 삭제
2. 완료 응답 반환

Alternative Flow

Exception Flow
1. 상품 존재하지 않을 시(404) 에러 반환
2. 서버 에러 시(500) 에러 반환

---
### 좋아요

**[유저 스토리]**
- 회원은 상품에 좋아요를 할 수 있다.
- 좋아요한 상품을 좋아요하면 취소된다.

**[기능 흐름]**
- 회원만 좋아요 가능
- 좋아요 여부 확인
- 있으면 좋아요 취소, 없으면 좋아요 처리

**[유스케이스 흐름]**

Main Flow
1. 회원이 상품에 좋아요
2. 좋아요 처리
3. 완료 응답 반환

Alternative Flow
1. 회원이 좋아요한 상품에 좋아요
2. 좋아요 취소 처리
3. 완료 응답 반환

Exception Flow
1. 상품 존재하지 않을 시(404) 에러 반환
2. 서버 에러 시(500) 에러 반환

---
### 주문 요청

**[유저 스토리]**
- 회원은 상품을 주문할 수 있다.
- 주문 시 상품 정보, 수량, 배송지 정보 등을 입력하여 주문한다.

**[기능 흐름]**
- 회원만 주문 가능
- 주문 시 상품 존재 여부 확인.
- 상품 재고 확인.
- 재고 있을 시 재고 차감 후 주문 처리
- 재고 없으면 에러 반환.

**[유스케이스 흐름]**

Main Flow
1. 회원이 상품 주문 요청
2. 상품 존재 여부 확인
3. 상품 재고 확인
4. 재고 차감 후 주문 정보 생성
5. 완료 응답 반환

Alternative Flow

Exception Flow
1. 상품 존재하지 않을 시(404) 에러 반환
2. 상품 재고 부족 시(400) 에러 반환
3. 서버 에러 시(500) 에러 반환

---
### 주문 목록 및 상세 조회

**[유저 스토리]**
- 회원은 자신의 주문 목록을 조회할 수 있다.
- 주문을 선택하여 상세 정보를 조회할 수 있다.

**[기능 흐름]**
- 회원이 자신의 주문 목록 조회.
- 날짜 범위를 지정하여 목록 조회.
- 해당 날짜에 포함된 주문 목록 반환.
- 해당 날짜에 주문이 없으면 빈 리스트 반환.
- 주문을 선택하여 상세 정보 조회.

**[유스케이스 흐름]**

Main Flow
1. 회원이 원하는 날짜의 주문 목록 조회.
2. 해당 날짜의 주문 목록 반환.
3. 회원이 원하는 주문 선택.
4. 주문 상세 정보 반환.

Alternative Flow
1. 날짜 범위 내 주문 없을 시 빈 리스트 반환

Exception Flow
1. 상세 주문 존재하지 않을 시(404) 에러 반환
2. 서버 에러 시(500) 에러 반환

---
### Admin 주문 목록 조회, 단일 주문 상세 조회

**[유저 스토리]**
- 관리자는 주문 목록을 조회할 수 있다.
- 주문을 선택하여 상세 정보를 조회할 수 있다.

**[기능 흐름]**
- 관리자가 모든 회원의 주문 목록 조회.
- 기본 20개씩 페이지네이션 처리.
- 주문 없을 시 빈 리스트 반환.
- 주문을 선택하여 상세 정보 조회.

**[유스케이스 흐름]**

Main Flow
1. 관리자가 주문 목록 조회.
2. 기본 20개씩 페이지네이션 처리된 주문 목록 반환.
3. 관리자가 원하는 주문 선택.
4. 주문 상세 정보 반환.

Alternative Flow
1. 주문 없을 시 빈 리스트 반환

Exception Flow
1. 상세 주문 존재하지 않을 시(404) 에러 반환
2. 서버 에러 시(500) 에러 반환
