---
name: refactor
description:
  TDD Refactor Phase / Tidy First. 모든 테스트가 통과하는 상태에서 구조적 변경만 수행한다.
  중복 제거, 네이밍 개선, 메서드 추출, 가드 절 도입 등. 테스트 실패 시 되돌린다.
---

리팩토링 대상/방향: $ARGUMENTS

## 절차

1. 전체 테스트 통과 확인: `./gradlew test` (실패 시 중단)
2. `$ARGUMENTS`가 있으면 해당 대상 우선 처리, 없으면 개선점 제안
3. 한 번에 하나의 구조적 변경 수행:
   **프로덕션 코드:**
   - 중복 제거
   - 네이밍 개선
   - 메서드 추출 (단일 책임)
   - 가드 절 도입
   - 설명 변수 도입
   - 코드 이동
   - unused import 제거
   **테스트 코드:**
   - 공통 Arrange를 @BeforeEach로 추출
   - 테스트 픽스처/헬퍼 추출
   - @Nested 구조 재정리
   - 테스트명 개선 (의도 명확화)
   - 중복 시나리오 제거
4. 린트 수정: `./gradlew ktlintFormat`
5. 린트 체크: `./gradlew ktlintCheck`
6. 전체 테스트 재확인: `./gradlew test` (실패 시 되돌리기)
7. 결과 보고

## 규칙

- **구조적 변경만** (동작 변경 절대 금지)
- 한 번에 하나의 변경만 수행
- 행위적 변경이 필요하면 별도 작업으로 제안
- 테스트 실패 시 변경을 되돌리고 보고
