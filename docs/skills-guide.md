# 커스텀 커맨드 & 스킬 가이드

이 프로젝트에서 사용하는 Claude Code 슬래시 커맨드와 스킬 목록.

---

## 개요

TDD (Red → Green → Refactor) + Tidy First + 설계 워크플로우에 맞춘 17개 커맨드/스킬.

| 카테고리       | 커맨드 수 | 목적                   |
|------------|-------|----------------------|
| TDD 사이클    | 4개    | 테스트 주도 개발 단계별 수행     |
| 검증 및 커밋    | 2개    | 품질 검증, Tidy First 커밋 |
| 계획 및 설계    | 2개    | plan.md 관리, 설계 리뷰    |
| 설계 산출물     | 3개    | Mermaid 다이어그램 생성     |
| 테스트 및 문서   | 2개    | E2E 테스트, HTTP 파일     |
| 결함 수정 및 정리 | 2개    | 버그 수정 TDD, 구조적 변경    |
| 요구사항 분석    | 1개    | 요구사항 → 설계 전환 (스킬)    |

---

## 1. TDD 사이클

### `/go` — plan.md 기반 TDD 자동 수행

- **인자**: 없음
- **역할**: `plan.md`를 읽고 다음 미완료(`- [ ]`) 항목을 찾아 Red → Green 사이클을 자동 수행
- **흐름**: plan.md 읽기 → 진행 상황 요약 → 미완료 항목 선택 → 실패 테스트 작성 → 최소 구현 → 전체 테스트 → plan.md 체크
- **사용 시점**: plan.md가 준비된 후, 반복적으로 `/go` → `/go` → `/go`로 항목을 하나씩 소화

### `/red` — 실패 테스트 작성 (Red Phase)

- **인자**: 요구사항 설명
- **역할**: 요구사항에 대한 실패하는 테스트를 **하나만** 작성
- **판단**: 단위/통합/E2E 중 적절한 테스트 종류를 자동 선택
- **사용 시점**: 수동 TDD 제어 시, 특정 요구사항의 테스트를 직접 지정하고 싶을 때

### `/green` — 최소 구현 (Green Phase)

- **인자**: 없음
- **역할**: 현재 실패 중인 테스트를 통과시키기 위한 **최소한의 코드만** 구현
- **원칙**: 오버엔지니어링 금지, 레이어드 아키텍처 패턴 준수
- **사용 시점**: `/red` 이후, 테스트를 통과시킬 구현이 필요할 때

### `/refactor` — 코드 품질 개선 (Refactor Phase)

- **인자**: 대상/방향 (선택)
- **역할**: 모든 테스트가 통과하는 상태에서 구조적 변경만 수행
- **범위**: 중복 제거, 네이밍 개선, 메서드 추출, unused import 제거
- **안전장치**: 테스트 실패 시 변경 되돌리기
- **사용 시점**: Green 이후, 코드 정리가 필요할 때

---

## 2. 검증 및 커밋

### `/verify` — 린트 + 테스트 최종 검증

- **인자**: 없음
- **역할**: `ktlintCheck` + `test` + `git status`를 실행하고 결과를 정형화된 보고서로 출력
- **판정**: 린트 + 테스트 모두 통과 시 "커밋 가능", 아니면 수정 필요 항목 안내
- **사용 시점**: 커밋 직전, 최종 검증

### `/commit` — Tidy First 규칙 커밋

- **인자**: 없음
- **역할**: 린트+테스트 통과 확인 → 변경 유형 분석(구조적/행위적) → 커밋 메시지 생성
- **핵심 규칙**: 구조적 변경과 행위적 변경을 절대 같은 커밋에 섞지 않음
- **사용 시점**: `/verify` 통과 후

---

## 3. 계획 및 설계

### `/plan` — plan.md 작성/업데이트

- **인자**: 요구사항/PRD (선택)
- **역할**: 요구사항을 TDD로 구현할 수 있는 단위로 분해하여 체크리스트(`- [ ]`) 형태로 작성
- **구조**: 도메인 모델 → 저장소 → 서비스 → API → E2E 순서 (의존성 방향)
- **사용 시점**: 새 기능 개발 시작 전

### `/design-review` — 설계 문서 전체 리뷰

- **인자**: 없음
- **역할**: `docs/week2/` 아래 4개 설계 문서를 읽고 체크리스트 기반으로 리뷰
- **검증 항목**: 유저 시나리오, 시퀀스 책임 분리, 클래스 Entity/VO 구분, ERD 정합성
- **사용 시점**: 설계 문서 작성 완료 후, PR 제출 전

---

## 4. 설계 산출물 (Mermaid)

### `/sequence` — 시퀀스 다이어그램 작성

- **인자**: 대상 기능
- **역할**: 기능의 호출 흐름을 Mermaid 시퀀스 다이어그램으로 작성
- **포함 내용**: 레이어드 아키텍처 참여자, 조건 분기(`alt/else`), 트랜잭션 경계(`note`)
- **저장**: `docs/week2/02-sequence-diagrams.md`

### `/class-diagram` — 클래스 다이어그램 작성

- **인자**: 대상 도메인
- **역할**: 도메인 객체를 Mermaid 클래스 다이어그램으로 작성
- **구분**: Entity(`-->` association) vs VO(`*--` composition), 비즈니스 메서드 필수 포함
- **저장**: `docs/week2/03-class-diagram.md`

### `/erd` — ERD 작성

- **인자**: 대상 도메인
- **역할**: 영속성 구조를 Mermaid ERD로 작성
- **규칙**: 테이블명 복수형, soft delete(`deleted_at`), VO는 컬럼으로 표현, N:M은 조인 테이블
- **저장**: `docs/week2/04-erd.md`

---

## 5. 테스트 및 문서

### `/e2e` — E2E 테스트 작성

- **인자**: 대상 API (선택)
- **역할**: 실제 API를 호출해 전체 흐름(Controller → Facade → Service → Repository)을 검증하는 테스트 작성
- **환경**: `@SpringBootTest(webEnvironment = RANDOM_PORT)` + `TestRestTemplate` + TestContainers
- **원칙**: Mock 사용 금지, 정상 + 실패 케이스 모두 포함

### `/http` — HTTP 요청 파일 작성

- **인자**: 대상 API (선택)
- **역할**: 개발 완료된 API에 대한 IntelliJ HTTP Client 형식(`.http`) 파일 작성
- **구조**: 도메인별 파일 분류 (`http/user.http`, `http/product.http` 등)
- **포함**: 정상 + 에러 케이스, 실제로 동작하는 값 사용

---

## 6. 결함 수정 및 정리

### `/fix` — 버그 재현 테스트 → 수정

- **인자**: 결함 설명
- **역할**: Step 1(API 레벨 재현) → Step 2(최소 재현 단위 테스트) → Step 3(최소 수정)
- **원칙**: 반드시 실패 테스트 먼저, 테스트 없이 수정 금지

### `/tidy` — 동작 변경 없는 구조적 변경

- **인자**: 대상/방향 (선택)
- **역할**: 이름 변경, 메서드 추출, 코드 이동, 가드 절 도입 등 구조적 변경만 수행
- **안전장치**: 전체 테스트 실행 → 실패 시 되돌리기
- **원칙**: 동작 변경 절대 금지, 한 번에 하나의 변경만

---

## 7. 요구사항 분석 (스킬)

### `/requirements-analysis` — 요구사항 → 설계 전환

- **위치**: `~/.claude/skills/requirements-analysis/SKILL.md` (글로벌 스킬)
- **역할**: 요구사항을 분석하고, 개발자와 Q&A를 통해 애매한 부분을 명확히 한 뒤 설계 산출물 생성
- **7단계 흐름**:
    1. 문제 재해석 — "무엇을 만들까?"가 아니라 "어떤 문제를 해결하는가?"
    2. 애매한 점 노출 — 결정되지 않은 부분을 명시적으로 나열
    3. 질문 제시 — 선택지 + 영향도를 함께 제시 (정책/경계/확장/동시성)
    4. 개념 모델 — 액터, 핵심 도메인, 유비쿼터스 언어 정의
    5. 다이어그램 — 이유 → Mermaid 다이어그램 → 해석 순서
    6. 해석 — 봐야 할 포인트 2~3줄, 다이어그램 간 정합성 확인
    7. 잠재 리스크 — 트랜잭션, 결합도, 동시성 등 위험 요소 언급
- **산출물 저장 위치**:
    - `docs/week2/01-requirements.md`
    - `docs/week2/02-sequence-diagrams.md`
    - `docs/week2/03-class-diagram.md`
    - `docs/week2/04-erd.md`

---

## 워크플로우 예시

### A. 설계 (요구사항 → 문서)

```
/requirements-analysis          → 요구사항 분석 + Q&A
/sequence 주문 생성 흐름         → 시퀀스 다이어그램
/class-diagram 주문 도메인       → 클래스 다이어그램
/erd 주문 도메인                 → ERD
/design-review                  → 전체 설계 리뷰
/commit                         → 커밋
```

### B. 새 기능 개발 (plan.md 기반 자동)

```
/plan 요구사항 설명              → plan.md 작성
/go → /go → /go → ...          → 항목 하나씩 TDD 소화
/refactor                       → 코드 정리
/verify                         → 최종 검증
/commit                         → 커밋
/http                           → HTTP 파일 작성
```

### C. 단계별 수동 TDD

```
/red 요구사항 설명               → 실패 테스트
/green                          → 최소 구현
/refactor                       → 코드 정리
/e2e                            → E2E 테스트
/verify                         → 최종 검증
/commit                         → 커밋
```

### D. 결함 수정

```
/fix 결함 설명                   → 재현 테스트 + 수정
/verify                         → 최종 검증
/commit                         → 커밋
```
