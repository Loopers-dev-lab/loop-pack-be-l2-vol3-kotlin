# API 요구사항 명세서

## 📦 범위: 브랜드 & 상품 Admin API

---

## 📊 개념 모델

### 액터 (Actor)

| 액터 | 설명 |
|------|------|
| **관리자 (Admin)** | LDAP 인증을 통해 브랜드/상품 관리 기능 사용 가능 |

### 핵심 도메인 (Core Domain)

| 도메인 | 책임 |
|--------|------|
| **브랜드 (Brand)** | 브랜드 정보 관리 (CRUD), Soft Delete |
| **상품 (Product)** | 상품 정보 관리 (CRUD), 브랜드 귀속 |

### 엔티티 관계도

```
┌─────────┐  1    N  ┌─────────┐
│  Brand  │ ◀─────── │ Product │
└─────────┘          └─────────┘
     │                    │
     │ Soft Delete        │
     │                    │
     ▼                    ▼
 deleted_at          deleted_at
```

### 삭제 정책

```
브랜드 삭제 시:
┌──────────────────────────────────────────┐
│  Brand.deleted_at = NOW()                │
│         │                                │
│         ▼                                │
│  Product.deleted_at = NOW()              │
│  (해당 브랜드의 모든 상품)                  │
└──────────────────────────────────────────┘
```

---

## 📖 유저 스토리 (User Stories)

### 브랜드 관리

| ID | 역할 | 스토리 |
|----|------|--------|
| US-B01 | 관리자 | 등록된 브랜드 목록을 페이징하여 조회한다 |
| US-B02 | 관리자 | 브랜드 ID로 브랜드 상세 정보를 조회한다 |
| US-B03 | 관리자 | 존재하지 않는 브랜드 조회 시 404 에러를 반환받는다 |
| US-B04 | 관리자 | 새로운 브랜드를 등록한다 |
| US-B05 | 관리자 | 이미 존재하는 브랜드명으로 등록 시 에러를 반환받는다 |
| US-B06 | 관리자 | 기존 브랜드 정보를 수정한다 |
| US-B07 | 관리자 | 브랜드를 삭제한다 (Soft Delete) |
| US-B08 | 관리자 | 브랜드 삭제 시 해당 브랜드의 상품들도 함께 삭제된다 |

### 상품 관리

| ID | 역할 | 스토리 |
|----|------|--------|
| US-P01 | 관리자 | 브랜드에 포함된 상품 목록을 페이징하여 조회한다 |
| US-P02 | 관리자 | 상품 ID로 상품 상세 정보를 조회한다 |
| US-P03 | 관리자 | 존재하지 않는 상품 조회 시 404 에러를 반환받는다 |
| US-P04 | 관리자 | 새로운 상품을 등록한다 |
| US-P05 | 관리자 | 존재하지 않는 브랜드로 상품 등록 시 400 에러를 반환받는다 |
| US-P06 | 관리자 | 중복된 상품명으로 등록 시 400 에러를 반환받는다 |
| US-P07 | 관리자 | 기존 상품 정보를 수정한다 (브랜드 변경 불가) |
| US-P08 | 관리자 | 상품을 삭제한다 |

---

## 📚 도메인 용어 정의

| 용어 | 영문 | 정의 |
|------|------|------|
| 브랜드 | Brand | 상품을 판매하는 주체. 브랜드명, 설명 등의 정보를 가진다 |
| 상품 | Product | 브랜드가 판매하는 개별 아이템. 하나의 브랜드에만 속한다 |

---

## 🔄 기능 흐름 (Feature Flow)

### 1. 브랜드 목록 조회 흐름

```
[Admin] ──GET /api-admin/v1/brands?page=0&size=20──▶ [Server]
                                                          │
                                                          ▼
                                                   LDAP 인증 검증
                                                          │
                                      ┌───────────────────┴───────────────────┐
                                      ▼                                       ▼
                                인증 성공                                 인증 실패
                                      │                                       │
                                      ▼                                       ▼
                           size 값 검증 (20/50/100)                    401 Unauthorized
                                      │
                                      ▼
                              페이징 처리 및 조회
                                      │
                      ┌───────────────┴───────────────┐
                      ▼                               ▼
                페이지 존재                      페이지 미존재
                      │                               │
                      ▼                               ▼
           200 OK + 브랜드 목록 반환            404 Not Found
```

### 2. 브랜드 등록 흐름

```
[Admin] ──POST /api-admin/v1/brands──▶ [Server]
                                            │
                                            ▼
                                     LDAP 인증 검증
                                            │
                        ┌───────────────────┴───────────────────┐
                        ▼                                       ▼
                  인증 성공                                 인증 실패
                        │                                       │
                        ▼                                       ▼
                 브랜드명 중복 검사                       401 Unauthorized
                        │
        ┌───────────────┴───────────────┐
        ▼                               ▼
   브랜드명 사용 가능              브랜드명 중복
        │                               │
        ▼                               ▼
   브랜드 저장                   400 Bad Request
        │
        ▼
   200 OK + 브랜드 정보 반환
```

### 3. 브랜드 삭제 흐름

```
[Admin] ──DELETE /api-admin/v1/brands/{brandId}──▶ [Server]
                                                        │
                                                        ▼
                                                 LDAP 인증 검증
                                                        │
                                                        ▼
                                                 브랜드 Soft Delete
                                                        │
                                                        ▼
                                            해당 브랜드 상품들 Soft Delete
                                                        │
                                                        ▼
                                                   200 OK 반환
```

### 4. 상품 등록 흐름

```
[Admin] ──POST /api-admin/v1/products──▶ [Server]
                                              │
                                              ▼
                                       LDAP 인증 검증
                                              │
                                              ▼
                                       브랜드 존재 확인
                                              │
                          ┌───────────────────┴───────────────────┐
                          ▼                                       ▼
                    브랜드 존재                              브랜드 미존재
                          │                                       │
                          ▼                                       ▼
                   상품명 중복 검사                         400 Bad Request
                          │
          ┌───────────────┴───────────────┐
          ▼                               ▼
     상품명 사용 가능                상품명 중복
          │                               │
          ▼                               ▼
     상품 저장                     400 Bad Request
          │
          ▼
     200 OK + 상품 정보 반환
```

---

## 1. 브랜드 목록 조회 API

### 목표
등록된 브랜드 목록을 조회하는 API를 개발한다

### 기본 정보

| 항목 | 내용 |
|------|------|
| Method | `GET` |
| Endpoint | `/api-admin/v1/brands` |
| 인증 | LDAP 인증 필수 |

### 요구사항
- 등록된 브랜드 목록을 조회한다
- 페이징 처리되어 페이징 크기에 따라 조회된다

### 제한사항
- 페이징 크기는 20, 50, 100으로 제한한다
- 존재하지 않는 페이지로 조회 시 `404 Not Found` 에러를 반환한다

### 요청 파라미터

| 파라미터 | 타입 | 필수 | 기본값 | 설명 |
|---------|------|------|-------|------|
| page | Integer | N | 0 | 페이지 번호 |
| size | Integer | N | 20 | 페이지당 조회 개수 (20, 50, 100) |

### 응답 예시
```json
{
  "content": [
    {
      "brandId": 1,
      "name": "브랜드명",
      "description": "브랜드 설명",
      "createdAt": "2026-02-13T00:00:00",
      "updatedAt": "2026-02-13T00:00:00"
    }
  ],
  "page": 0,
  "size": 20,
  "totalElements": 100,
  "totalPages": 5
}
```

---

## 2. 브랜드 상세 조회 API

### 목표
브랜드 상세 조회하는 API를 개발한다

### 기본 정보

| 항목 | 내용 |
|------|------|
| Method | `GET` |
| Endpoint | `/api-admin/v1/brands/{brandId}` |
| 인증 | LDAP 인증 필수 |

### 요구사항
- 브랜드 ID에 해당하는 브랜드 상세를 조회한다

### 제한사항
- 존재하지 않는 브랜드 ID로 조회 시 `404 Not Found` 에러를 반환한다

### 응답 예시
```json
{
  "brandId": 1,
  "name": "브랜드명",
  "description": "브랜드 설명",
  "createdAt": "2026-02-13T00:00:00",
  "updatedAt": "2026-02-13T00:00:00"
}
```

---

## 3. 브랜드 신규 등록 API

### 목표
브랜드를 신규 등록하는 API를 개발한다

### 기본 정보

| 항목 | 내용 |
|------|------|
| Method | `POST` |
| Endpoint | `/api-admin/v1/brands` |
| 인증 | LDAP 인증 필수 |

### 요구사항
- 브랜드를 신규로 등록한다
- 등록 성공시 200을 반환한다

### 제한사항
- 이미 존재하는 브랜드명으로 등록 시 에러를 반환한다

### 요청 Body
```json
{
  "name": "브랜드명",
  "description": "브랜드 설명"
}
```

### 응답 예시
```json
{
  "brandId": 1,
  "name": "브랜드명",
  "description": "브랜드 설명",
  "createdAt": "2026-02-13T00:00:00"
}
```

---

## 4. 브랜드 정보 수정 API

### 목표
브랜드 정보를 수정하는 API를 개발한다

### 기본 정보

| 항목 | 내용 |
|------|------|
| Method | `PUT` |
| Endpoint | `/api-admin/v1/brands/{brandId}` |
| 인증 | LDAP 인증 필수 |

### 요구사항
- 브랜드 정보를 수정한다
- 수정 성공시 200을 반환한다

### 제한사항
- 이미 존재하는 브랜드명으로 수정 시 에러를 반환한다

### 요청 Body
```json
{
  "name": "수정된 브랜드명",
  "description": "수정된 브랜드 설명"
}
```

### 응답 예시
```json
{
  "brandId": 1,
  "name": "수정된 브랜드명",
  "description": "수정된 브랜드 설명",
  "updatedAt": "2026-02-13T00:00:00"
}
```

---

## 5. 브랜드 삭제 API

### 목표
브랜드 정보를 삭제하는 API를 개발한다

### 기본 정보

| 항목 | 내용 |
|------|------|
| Method | `DELETE` |
| Endpoint | `/api-admin/v1/brands/{brandId}` |
| 인증 | LDAP 인증 필수 |

### 요구사항
- 브랜드 정보를 삭제한다
- 삭제 성공시 200을 반환한다
- 브랜드 삭제 시 브랜드의 상품들도 삭제되어야 한다
- 삭제의 경우 soft delete로 삭제한다

### 응답 예시
```json
{
  "message": "브랜드가 삭제되었습니다",
  "deletedAt": "2026-02-13T00:00:00"
}
```

---

## 6. 상품 목록 조회 API

### 목표
등록된 브랜드의 상품 목록을 조회하는 API를 개발한다

### 기본 정보

| 항목 | 내용 |
|------|------|
| Method | `GET` |
| Endpoint | `/api-admin/v1/products` |
| 인증 | LDAP 인증 필수 |

### 요구사항
- 브랜드에 포함된 상품 목록을 조회한다
- 페이징 처리되어 페이징 크기에 따라 조회된다

### 제한사항
- 페이징 크기는 20, 50, 100으로 제한한다
- 존재하지 않는 브랜드에 대해 조회하는 경우 `404 Not Found` 에러를 반환한다
- 존재하지 않는 페이지로 조회 시 `404 Not Found` 에러를 반환한다

### 요청 파라미터

| 파라미터 | 타입 | 필수 | 기본값 | 설명 |
|---------|------|------|-------|------|
| page | Integer | N | 0 | 페이지 번호 |
| size | Integer | N | 20 | 페이지당 조회 개수 (20, 50, 100) |
| brandId | Long | N | - | 브랜드 ID 필터 |

### 응답 예시
```json
{
  "content": [
    {
      "productId": 1,
      "name": "상품명",
      "description": "상품 설명",
      "price": 10000,
      "brandId": 1,
      "createdAt": "2026-02-13T00:00:00",
      "updatedAt": "2026-02-13T00:00:00"
    }
  ],
  "page": 0,
  "size": 20,
  "totalElements": 100,
  "totalPages": 5
}
```

---

## 7. 상품 상세 조회 API

### 목표
상품 상세 정보 조회하는 API를 개발한다

### 기본 정보

| 항목 | 내용 |
|------|------|
| Method | `GET` |
| Endpoint | `/api-admin/v1/products/{productId}` |
| 인증 | LDAP 인증 필수 |

### 요구사항
- 상품 상세 정보를 조회한다

### 제한사항
- 존재하지 않는 상품에 대해 조회하는 경우 `404 Not Found` 에러를 반환한다

### 응답 예시
```json
{
  "productId": 1,
  "name": "상품명",
  "description": "상품 설명",
  "price": 10000,
  "brandId": 1,
  "createdAt": "2026-02-13T00:00:00",
  "updatedAt": "2026-02-13T00:00:00"
}
```

---

## 8. 상품 신규 등록 API

### 목표
상품을 신규로 등록하는 API를 개발한다

### 기본 정보

| 항목 | 내용 |
|------|------|
| Method | `POST` |
| Endpoint | `/api-admin/v1/products` |
| 인증 | LDAP 인증 필수 |

### 요구사항
- 상품을 신규로 등록한다
- 신규 등록하는 상품의 브랜드는 이미 등록된 브랜드여야 한다
- 상품 이름은 중복될 수 없다
- 정상 등록시 200 코드 반환

### 제한사항
- 존재하지 않는 브랜드로 등록 시 `400 Bad Request` 에러 발생
- 중복된 이름으로 등록시 `400 Bad Request` 에러 발생

### 요청 Body
```json
{
  "name": "상품명",
  "description": "상품 설명",
  "price": 10000,
  "brandId": 1
}
```

### 응답 예시
```json
{
  "productId": 1,
  "name": "상품명",
  "description": "상품 설명",
  "price": 10000,
  "brandId": 1,
  "createdAt": "2026-02-13T00:00:00"
}
```

---

## 9. 상품 정보 수정 API

### 목표
상품 정보를 수정하는 API를 개발한다

### 기본 정보

| 항목 | 내용 |
|------|------|
| Method | `PUT` |
| Endpoint | `/api-admin/v1/products/{productId}` |
| 인증 | LDAP 인증 필수 |

### 요구사항
- 상품 정보를 수정한다
- 상품의 브랜드는 변경할 수 없다
- 상품 이름은 중복될 수 없다
- 정상 수정시 200 코드 반환

### 제한사항
- 중복된 이름으로 수정시 `400 Bad Request` 에러 발생

### 요청 Body
```json
{
  "name": "수정된 상품명",
  "description": "수정된 상품 설명",
  "price": 15000
}
```

### 응답 예시
```json
{
  "productId": 1,
  "name": "수정된 상품명",
  "description": "수정된 상품 설명",
  "price": 15000,
  "brandId": 1,
  "updatedAt": "2026-02-13T00:00:00"
}
```

---

## 10. 상품 삭제 API

### 목표
상품 정보 삭제 API를 개발한다

### 기본 정보

| 항목 | 내용 |
|------|------|
| Method | `DELETE` |
| Endpoint | `/api-admin/v1/products/{productId}` |
| 인증 | LDAP 인증 필수 |

### 요구사항
- 상품 정보를 삭제한다
- 정상 삭제시 200 코드 반환

### 제한사항
- 없는 상품 삭제 시 `400 Bad Request` 에러 반환

### 응답 예시
```json
{
  "message": "상품이 삭제되었습니다",
  "deletedAt": "2026-02-13T00:00:00"
}
```
