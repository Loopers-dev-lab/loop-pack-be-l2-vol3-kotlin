# API 요구사항 명세서

## 📦 범위: 주문 관리 (Admin)

---

## 📊 개념 모델

### 액터 (Actor)

| 액터 | 설명 |
|------|------|
| **관리자 (Admin)** | LDAP 인증된 사용자, 주문 관리 기능 사용 가능 |

### 핵심 도메인 (Core Domain)

| 도메인 | 책임 |
|--------|------|
| **주문 (Order)** | 주문 정보 관리, 주문 항목 관리 |
| **주문 항목 (Order Item)** | 주문에 포함된 개별 상품 및 수량 관리 |

### 엔티티 관계도

```
┌─────────┐  1    N  ┌─────────────┐
│  Order  │ ◀─────── │ Order Item  │
└─────────┘          └─────────────┘
     │
     │ N
     ▼
┌─────────┐
│  User   │
└─────────┘
```

---

## 📖 유저 스토리 (User Stories)

### 주문 목록 조회

| ID | 역할 | 스토리 |
|----|------|--------|
| US-AO01 | 관리자 | 전체 주문 목록을 조회한다 |
| US-AO02 | 관리자 | 주문 목록을 페이징하여 조회한다 |
| US-AO03 | 관리자 | 페이지당 조회 개수를 20/50/100개로 변경하여 조회한다 |

### 주문 상세 조회

| ID | 역할 | 스토리 |
|----|------|--------|
| US-AO04 | 관리자 | 주문 ID로 주문 상세 정보를 조회한다 |
| US-AO05 | 관리자 | 존재하지 않는 주문 조회 시 404 에러를 반환받는다 |

---

## 📚 도메인 용어 정의

| 용어 | 영문 | 정의 |
|------|------|------|
| 주문 | Order | 사용자가 상품을 구매하기 위해 요청하는 행위 |
| 주문 항목 | Order Item | 주문에 포함된 개별 상품과 수량 정보 |

---

## 🔄 기능 흐름 (Feature Flow)

### 1. 주문 목록 조회 흐름

```
[Admin] ──GET /api-admin/v1/orders?page=0&size=20──▶ [Server]
                                                         │
                                                         ▼
                                                   LDAP 인증 검증
                                                         │
                                       ┌─────────────────┴─────────────────┐
                                       ▼                                   ▼
                                 인증 성공                             인증 실패
                                       │                                   │
                                       ▼                                   ▼
                             요청 파라미터 파싱                      401 Unauthorized
                                       │
                                       ▼
                             size 값 검증 (20/50/100)
                                       │
                                       ▼
                             주문 목록 조회
                                       │
                                       ▼
                                 페이징 처리
                                       │
                                       ▼
                   200 OK + 주문 목록 (페이징 정보 포함) 반환
```

### 2. 주문 상세 조회 흐름

```
[Admin] ──GET /api-admin/v1/orders/{orderId}──▶ [Server]
                                                    │
                                                    ▼
                                              LDAP 인증 검증
                                                    │
                                  ┌─────────────────┴─────────────────┐
                                  ▼                                   ▼
                            인증 성공                             인증 실패
                                  │                                   │
                                  ▼                                   ▼
                          orderId 유효성 검증                    401 Unauthorized
                                  │
                  ┌───────────────┴───────────────┐
                  ▼                               ▼
              주문 존재                       주문 미존재
                  │                               │
                  ▼                               ▼
            주문 상세 조회                   404 Not Found
                  │
                  ▼
        200 OK + 주문 상세 정보 반환
```

---

## 1. 주문 목록 조회 API

### 목표
주문 목록을 조회하는 API를 개발한다

### 기본 정보

| 항목 | 내용 |
|------|------|
| Method | `GET` |
| Endpoint | `/api-admin/v1/orders` |
| 인증 | LDAP 인증 필요 |

### 요구사항

#### 인증
- 해당 API 호출은 LDAP 인증을 요구한다

#### 페이징
- 주문 목록은 페이징 처리가 되어야 한다
- 페이지당 조회 개수: **기본 20개**, 변경 가능 (50, 100개)

### 요청 파라미터

| 파라미터 | 타입 | 필수 | 기본값 | 설명 |
|---------|------|------|-------|------|
| page | Integer | N | 0 | 페이지 번호 |
| size | Integer | N | 20 | 페이지당 조회 개수 (20, 50, 100) |

### 응답 예시
```json
{
  "content": [
    {
      "orderId": 1,
      "userId": 100,
      "totalAmount": 25000,
      "itemCount": 3,
      "orderedAt": "2026-02-13T12:30:00"
    },
    {
      "orderId": 2,
      "userId": 101,
      "totalAmount": 15000,
      "itemCount": 1,
      "orderedAt": "2026-02-10T10:00:00"
    }
  ],
  "page": 0,
  "size": 20,
  "totalElements": 100,
  "totalPages": 5
}
```

---

## 2. 주문 상세 조회 API

### 목표
단일 주문 상세를 조회하는 API를 개발한다

### 기본 정보

| 항목 | 내용 |
|------|------|
| Method | `GET` |
| Endpoint | `/api-admin/v1/orders/{orderId}` |
| 인증 | LDAP 인증 필요 |

### 요구사항
- 단일 주문 상세를 조회한다
- 해당 API 호출은 LDAP 인증을 요구한다

### 제한사항
- 존재하지 않는 주문 ID로 조회 시 `404 Not Found` 에러를 반환한다

### 응답 예시
```json
{
  "orderId": 1,
  "userId": 100,
  "orderItems": [
    {
      "productId": 1,
      "productName": "상품명1",
      "price": 10000,
      "quantity": 2,
      "subtotal": 20000
    },
    {
      "productId": 2,
      "productName": "상품명2",
      "price": 5000,
      "quantity": 1,
      "subtotal": 5000
    }
  ],
  "totalAmount": 25000,
  "orderedAt": "2026-02-13T12:30:00"
}
```
